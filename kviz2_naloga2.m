f1 = @(x,y,z) 0.00130 * x.^2 + 0.00130 * y.^2 -1; f2 = @(x,y,z) 0.00053*x.^2 + 0.00053*y.^2 + 0.00053*z.^2 + 0.02600*x -1; f3 = @(x,y,z) -0.00015*x + 0.00011*y + z + -0.00350;

i0 = [1 4 2 5 7 3 6 8 4 7 5 6 9 7 8 9 1 4 8 10 2 5 9 10 3 6 10]; j0 = [1 1 2 2 2 3 3 3 4 4 5 6 6 7 7 7 8 8 8 8 9 9 9 9 10 10 10]; a0 = [0.00130 0.00053 0.00130 0.00053 0.00011 0.00130 0.00053 0.00011 0.00053 1 0.00053 0.00053 1 -0.00350 1 0.00011 -1 -1 -0.00350 0.00011 -1 -1 -0.00350 1 -1 -1 -0.00350]; A0 = full(sparse(i0,j0,a0));
i1 = [7 4 8 5 9  6 10]; j1 = [7 8 8 9 9 10 10]; a1 = [-0.00015 0.02600 -0.00015 0.02600 -0.00015 0.02600 -0.00015]; A1 = full(sparse(i1,j1,a1));
i2 = [1 4 2 5 3   6 10]; j2 = [8 8 9 9 10 10 10]; a2 = [0.00130 0.00053 0.00130 0.00053 0.00130 0.00053 0]; A2 = full(sparse(i2,j2,a2));

f = @(x, y, z) [f1(x, y, z); f2(x, y, z); f3(x, y, z)];
disp(norm(f(26, 15, 0)));

[X, E] = polyeig(A0,A1,A2);

vec1 = X(:,13)./X(10,13);
vec2 = X(:,14)./X(10,14);

tocka1 = [E(13) vec1(8) vec1(9)];
tocka2 = [E(14) vec2(8) vec2(9)];

disp(norm(tocka1 + tocka2));

T = @(l) A0+A1*l+A2*l^2;
dT = @(l) A1+2*A2*l;

[lambda, v] = zapLinAproks(T,dT,26,1,1e-16);
disp(norm(T(lambda) * v));

dT2 = @(l) dT(l) + 1/1000*ones(10);

[lambda, v] = zapLinAproks(T,dT2,26,10,1e-16);
disp(norm(T(lambda) * v));